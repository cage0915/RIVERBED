---
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';
import { getFolderTitle, getFolderOrder } from '../lib/constants';

// Get all albums and extract unique folders from their slugs
const albums = await getCollection('albums');
const folderSlugs = [...new Set(albums.map(album => album.slug.split('/')[0]))];

const sortedFolders = folderSlugs
    .map(slug => ({
        id: slug,
        title: getFolderTitle(slug),
        order: getFolderOrder(slug)
    }))
    .sort((a, b) => a.order - b.order);
---

<Layout title="RIVERBED">
    <main class="mx-auto px-2 py-8">
        <div class="folders-grid">
            {sortedFolders.map((folder) => (
                <a href={`/${folder.id}`} class="folder-card">
                    <h2 class="text-2xl font-fjalla tracking-wide uppercase">{folder.title}</h2>
                </a>
            ))}
        </div>
    </main>
</Layout>

<style>
    .folders-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 0.5rem;
        margin: 0 auto;
    }

    .folder-card {
        padding: 3rem 2rem;
        border: 2px solid #e5e7eb;
        border-radius: 0.5rem;
        text-align: center;
        transition: all 0.3s ease;
        text-decoration: none;
        color: inherit;
    }

    .folder-card:hover {
        border-color: #3b82f6;
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
        transform: translateY(-2px);
    }
</style>
